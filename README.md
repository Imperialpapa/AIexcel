# K-IFRS 데이터 검증

웹 기반 AI 스프레드시트 애플리케이션 - OpenAI GPT와 연동하여 자연어로 데이터를 처리하고 검증할 수 있습니다.

## 주요 기능

### 📊 스프레드시트 기능
- **멀티 시트 지원**: 여러 개의 시트를 가진 엑셀 파일 완벽 지원
- **빈 시트 표시**: 비어있는 시트도 탭에 표시
- **실시간 편집**: 셀을 직접 클릭하여 수정 가능
- **엑셀 가져오기/내보내기**: .xlsx 파일 읽기 및 저장
- **수식 및 서식 보존**: 원본 엑셀 파일의 수식과 서식을 완벽하게 보존
- **수식 표시**: 셀 클릭 시 수식 바에 원본 수식 표시
- **행/열 추가 및 삭제**: 우클릭 메뉴로 행과 열을 쉽게 추가/삭제
- **컨텍스트 메뉴**: 우클릭으로 복사, 붙여넣기, 삽입, 삭제 등 빠른 작업
- **다중 셀 선택**: Ctrl 키로 여러 셀 선택 및 편집

### 🚀 성능 최적화
- **비동기 파일 로드**: UI 블록 없이 대용량 엑셀 파일 로드
- **로딩 진행 상황 표시**: 파일 로드 중 실시간 진행 상황 표시
- **스마트 배치 렌더링**: 첫 20행은 즉시, 이후 200행씩 처리
- **이벤트 위임**: 메모리 사용량 최소화
- **성능 통계**: 실시간 렌더링 성능 표시
- **데이터 샘플링**: 1000행 이상 데이터의 AI 처리 지원
- **효율적인 파일 저장**: Shallow copy로 원본 파일 크기 유지 (압축 옵션 적용)

### 🎨 편집 및 서식 기능
- **셀 서식**: 굵게, 이탤릭, 밑줄 스타일 적용
- **색상 지정**: 텍스트 색상 및 배경색 자유롭게 변경
- **정렬 기능**: 열 기준 오름차순/내림차순 정렬
- **실행 취소/다시 실행**: Ctrl+Z/Y로 작업 되돌리기
- **복사/붙여넣기**: Ctrl+C/V 또는 우클릭 메뉴로 데이터 복사
- **행/열 헤더**: 엑셀처럼 행 번호(1, 2, 3...) 및 열 문자(A, B, C...) 표시
- **멀티 선택**: Shift+클릭으로 여러 행/열 범위 선택
- **키보드 네비게이션**: 방향키, PgUp/PgDn, Home, End로 셀 이동

### 🤖 AI 기능
- **자연어 명령**: "가격이 높은 순으로 정렬해줘" 같은 자연어로 데이터 조작
- **작업 히스토리**: 우측 패널에서 모든 AI 작업 내역 확인 (토큰 사용량 포함)
- **리사이즈 가능한 AI 패널**: 패널 왼쪽 가장자리를 드래그하여 너비 조절 (200px~600px)
- **오류 추적**: 성공/실패 여부를 시각적으로 표시
- **OpenAI GPT 연동**: GPT-3.5-turbo 또는 GPT-4 사용 가능
- **토큰 사용량 최적화**:
  - 샘플 행 수 설정 (기본 50행, 10~1000행)
  - 빈 값 자동 제거로 토큰 절약
  - 짧은 프롬프트로 입력 토큰 최소화
  - 실시간 토큰 사용량 표시

### 🔍 고급 데이터 기능
- **필터**: 열 기준으로 데이터 필터링, 체크박스로 값 선택
- **검색 및 바꾸기**: 텍스트 검색 및 일괄 변경, 대소문자 구분 옵션
- **데이터 유효성 검사**: 숫자 범위, 텍스트 길이, 목록 값 제한
- **수식 입력**: =SUM, =AVERAGE, =COUNT, =MAX, =MIN 지원

### ⌨️ 키보드 단축키
- **Ctrl+Z**: 실행 취소
- **Ctrl+Y**: 다시 실행
- **Ctrl+C**: 선택한 셀/행/열 복사
- **Ctrl+V**: 붙여넣기
- **Ctrl+F**: 검색 대화상자 열기
- **방향키 (↑↓←→)**: 셀 간 이동
- **Tab**: 오른쪽 셀로 이동
- **Enter**: 아래 셀로 이동
- **PgUp/PgDn**: 10행씩 위/아래 이동
- **Home**: 현재 행의 첫 셀로 이동 (Ctrl+Home: 첫 셀로 이동)
- **End**: 현재 행의 마지막 셀로 이동 (Ctrl+End: 마지막 셀로 이동)
- **Shift+클릭**: 행/열 범위 선택

## 사용 방법

### 1. 기본 사용
1. **파일 열기**: "📂 열기" 버튼으로 엑셀 파일 로드
2. **API Key 입력**: OpenAI API Key를 상단에 입력
3. **시트 전환**: 하단 탭으로 시트 이동
4. **데이터 편집**: 셀을 클릭하여 직접 수정
5. **AI 패널 크기 조절**: AI 패널 왼쪽 가장자리를 드래그하여 너비 조절
6. **행/열 선택**: 행 번호나 열 문자(A, B, C...)를 클릭하여 전체 행/열 선택
7. **범위 선택**: Shift 키를 누른 채 행/열 헤더를 클릭하여 범위 선택
8. **키보드 네비게이션**: 방향키로 셀 간 이동, Tab/Enter로 빠른 입력

### 2. AI 명령 실행
1. **샘플 행 수 설정** (토큰 절약)
   - 기본값: 50행 (테스트용으로 충분)
   - 대용량 데이터: 10~30행으로 설정하여 토큰 최소화
   - 전체 처리 필요: 100~1000행으로 증가
2. AI 명령어 입력란에 자연어 명령 입력
   - 예: "단가가 높은 순으로 정렬해줘"
   - 예: "수량이 5개 이하인 행만 남겨줘"
   - 예: "각 상품의 총액 컬럼을 추가해줘 (단가 × 수량)"
3. "✨ AI 실행" 버튼 클릭
4. AI 패널에서 작업 결과 및 토큰 사용량 확인

### 3. 고급 기능 사용

#### 필터
1. "🔍 필터" 버튼 클릭
2. 열 헤더의 ▼ 아이콘 클릭
3. 표시할 값 선택 후 "적용" 클릭

#### 검색 및 바꾸기
1. "🔎 검색" 버튼 클릭 또는 Ctrl+F
2. 검색할 텍스트 입력
3. "다음 찾기", "바꾸기", "모두 바꾸기" 중 선택

#### 데이터 유효성 검사
1. 셀 선택
2. "✓ 유효성" 버튼 클릭
3. 규칙 유형 선택 (숫자, 텍스트, 목록)
4. 최소/최대값 또는 허용 목록 입력
5. "적용" 클릭

#### 수식 입력
1. 셀 선택
2. 상단 수식 바에 수식 입력 (예: =SUM(A1:A10))
3. Enter 키로 적용
4. 지원 함수: SUM, AVERAGE, COUNT, MAX, MIN

### 4. 결과 저장
- "💾 저장" 버튼으로 수정된 데이터를 엑셀 파일로 다운로드

## 💰 AI 토큰 절약 팁

### 토큰 사용량 최소화 방법
1. **샘플 행 수 조절**
   - 테스트: 10~20행
   - 일반 작업: 50~100행
   - 대량 처리: 필요한 만큼만 (500~1000행)

2. **데이터 정리**
   - 앱이 자동으로 빈 값, null 제거
   - 불필요한 열은 사전에 삭제

3. **효율적인 프롬프트**
   - 명확하고 짧게 작성
   - "정렬해줘" vs "데이터를 가격 기준으로 오름차순 정렬해주세요"
   - 짧은 프롬프트가 토큰 절약!

4. **토큰 사용량 모니터링**
   - 콘솔(F12)에서 예상/실제 토큰 확인
   - AI 패널 히스토리에서 토큰 기록 확인

### 예상 토큰 사용량
| 데이터 크기 | 샘플 행 수 | 예상 토큰 |
|------------|-----------|----------|
| 1000행 × 5열 | 50행 | ~200-500 |
| 1000행 × 10열 | 50행 | ~400-800 |
| 1000행 × 5열 | 100행 | ~400-1000 |
| 1000행 × 10열 | 100행 | ~800-1500 |

*실제 토큰은 데이터 내용과 프롬프트에 따라 달라집니다.*

## 기술 스택

- **Frontend**: Vanilla JavaScript (프레임워크 없음)
- **스타일**: CSS3
- **엑셀 처리**: SheetJS (XLSX)
- **AI**: OpenAI API (GPT-3.5-turbo)

## 아키텍처

### 주요 클래스
| 클래스 | 기능 |
|--------|------|
| **GridManager** | 멀티 시트 관리, 렌더링, 셀 선택 |
| **ExcelIO** | 엑셀 파일 가져오기/내보내기 |
| **AIEngine** | OpenAI API 연동, 자연어 처리 |
| **CommandManager** | 실행 취소/다시 실행 (Command Pattern) |
| **ContextMenuManager** | 우클릭 컨텍스트 메뉴 |
| **CellFormatter** | 셀 서식 (굵게, 색상 등) |
| **RowColumnManager** | 행/열 추가/삭제 |
| **SortManager** | 데이터 정렬 |
| **FilterManager** | 데이터 필터링 |
| **SearchManager** | 검색 및 바꾸기 |
| **ValidationManager** | 데이터 유효성 검사 |
| **FormulaEngine** | 수식 처리 엔진 |

## 성능 개선 사항

| 항목 | 개선 전 | 개선 후 |
|------|---------|---------|
| 파일 로드 반응성 | UI 블록 | 즉시 반응 + 진행 표시 |
| 첫 화면 표시 | ~500ms | ~50ms (20행) |
| 1000행 전체 렌더링 | ~500-1000ms | ~200-300ms |
| 메모리 (1000행) | 10,000개 핸들러 | 1개 핸들러 |
| AI 최대 처리 | ~100행 | ~10,000행 |
| 빈 시트 표시 | ❌ | ✅ |

## GitHub Pages 배포

이 앱은 GitHub Pages로 배포할 수 있습니다:

**배포 URL**: `https://imperialpapa.github.io/AIexcel/`

### 수동 배포 설정 방법

1. GitHub 저장소 페이지로 이동
2. **Settings** → **Pages** 메뉴 선택
3. **Source**에서 `master` 브랜치 선택
4. **루트 디렉토리 (`/`)** 선택
5. **Save** 버튼 클릭
6. 약 1-2분 후 위 URL로 접속 가능

## 라이선스

MIT License

## 개발자

Generated with [Claude Code](https://claude.com/claude-code)
